import{aJ as D,aK as y,r as d,aL as F,aM as O,aN as Y,aO as A,aP as $,aQ as V,aR as G,aS as q,aT as J,aU as K,aV as Q,aW as w,aX as Z,aY as ee,A as te,_ as ne,j as r,m as b,u as E,a as se,aF as U,aZ as m,a_ as oe,aD as re,a$ as ie,ay as le,b0 as ae,aG as C,aI as ce,b1 as ue,aB as de}from"./index-a54ce840.js";import{L as fe}from"./LayoutResponsiveLeft-c56d00fc.js";import{D as ge,M as he}from"./index-e3738cf5.js";import{A as me}from"./index-2f904a6a.js";import{U as I,u as X}from"./useDispatch-7947887f.js";import{M as p}from"./index-52b4c50f.js";function pe(e){const t=D(()=>y(e)),{isStatic:o}=d.useContext(F);if(o){const[,n]=d.useState(e);d.useEffect(()=>t.on("change",n),[])}return t}function ve(e,t={}){const{isStatic:o}=d.useContext(F),n=d.useRef(null),s=pe(O(e)?e.get():e),i=()=>{n.current&&n.current.stop()};return d.useInsertionEffect(()=>s.attach((l,a)=>{if(o)return a(l);if(i(),n.current=Y({keyframes:[s.get(),l],velocity:s.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:a}),!A.isProcessing){const u=performance.now()-A.timestamp;u<30&&(n.current.time=$(u))}return s.get()},i),[JSON.stringify(t)]),V(()=>{if(O(e))return e.on("change",l=>s.set(parseFloat(l)))},[s]),s}function xe(e,t,o){var n;if(typeof e=="string"){let s=document;t&&(G(!!t.current),s=t.current),o?((n=o[e])!==null&&n!==void 0||(o[e]=s.querySelectorAll(e)),e=o[e]):e=s.querySelectorAll(e)}else e instanceof Element&&(e=[e]);return Array.from(e||[])}const L=new WeakMap;let h;function ye(e,t){if(t){const{inlineSize:o,blockSize:n}=t[0];return{width:o,height:n}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function Se({target:e,contentRect:t,borderBoxSize:o}){var n;(n=L.get(e))===null||n===void 0||n.forEach(s=>{s({target:e,contentSize:t,get size(){return ye(e,o)}})})}function we(e){e.forEach(Se)}function Le(){typeof ResizeObserver>"u"||(h=new ResizeObserver(we))}function je(e,t){h||Le();const o=xe(e);return o.forEach(n=>{let s=L.get(n);s||(s=new Set,L.set(n,s)),s.add(t),h==null||h.observe(n)}),()=>{o.forEach(n=>{const s=L.get(n);s==null||s.delete(t),s!=null&&s.size||h==null||h.unobserve(n)})}}const j=new Set;let S;function be(){S=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};j.forEach(o=>o(t))},window.addEventListener("resize",S)}function Ee(e){return j.add(e),S||be(),()=>{j.delete(e),!j.size&&S&&(S=void 0)}}function ke(e,t){return typeof e=="function"?Ee(e):je(e,t)}const Be=50,M=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),ze=()=>({time:0,x:M(),y:M()}),Ae={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function W(e,t,o,n){const s=o[t],{length:i,position:l}=Ae[t],a=s.current,u=o.time;s.current=e["scroll"+l],s.scrollLength=e["scroll"+i]-e["client"+i],s.offset.length=0,s.offset[0]=0,s.offset[1]=s.scrollLength,s.progress=q(0,s.scrollLength,s.current);const f=n-u;s.velocity=f>Be?0:J(s.current-a,f)}function He(e,t,o){W(e,"x",t,o),W(e,"y",t,o),t.time=o}function Oe(e,t){const o={x:0,y:0};let n=e;for(;n&&n!==t;)if(n instanceof HTMLElement)o.x+=n.offsetLeft,o.y+=n.offsetTop,n=n.offsetParent;else if(n.tagName==="svg"){const s=n.getBoundingClientRect();n=n.parentElement;const i=n.getBoundingClientRect();o.x+=s.left-i.left,o.y+=s.top-i.top}else if(n instanceof SVGGraphicsElement){const{x:s,y:i}=n.getBBox();o.x+=s,o.y+=i;let l=null,a=n.parentNode;for(;!l;)a.tagName==="svg"&&(l=a),a=n.parentNode;n=l}else break;return o}const Ce={Enter:[[0,1],[1,1]],Exit:[[0,0],[1,0]],Any:[[1,0],[0,1]],All:[[0,0],[1,1]]},H={start:0,center:.5,end:1};function R(e,t,o=0){let n=0;if(H[e]!==void 0&&(e=H[e]),typeof e=="string"){const s=parseFloat(e);e.endsWith("px")?n=s:e.endsWith("%")?e=s/100:e.endsWith("vw")?n=s/100*document.documentElement.clientWidth:e.endsWith("vh")?n=s/100*document.documentElement.clientHeight:e=s}return typeof e=="number"&&(n=t*e),o+n}const Ie=[0,0];function Me(e,t,o,n){let s=Array.isArray(e)?e:Ie,i=0,l=0;return typeof e=="number"?s=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?s=e.split(" "):s=[e,H[e]?e:"0"]),i=R(s[0],o,n),l=R(s[1],t),i-l}const We={x:0,y:0};function Re(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function Ne(e,t,o){let{offset:n=Ce.All}=o;const{target:s=e,axis:i="y"}=o,l=i==="y"?"height":"width",a=s!==e?Oe(s,e):We,u=s===e?{width:e.scrollWidth,height:e.scrollHeight}:Re(s),f={width:e.clientWidth,height:e.clientHeight};t[i].offset.length=0;let g=!t[i].interpolate;const v=n.length;for(let c=0;c<v;c++){const k=Me(n[c],f[l],u[l],a[i]);!g&&k!==t[i].interpolatorOffsets[c]&&(g=!0),t[i].offset[c]=k}g&&(t[i].interpolate=K(t[i].offset,Q(n)),t[i].interpolatorOffsets=[...t[i].offset]),t[i].progress=t[i].interpolate(t[i].current)}function Te(e,t=e,o){if(o.x.targetOffset=0,o.y.targetOffset=0,t!==e){let n=t;for(;n&&n!==e;)o.x.targetOffset+=n.offsetLeft,o.y.targetOffset+=n.offsetTop,n=n.offsetParent}o.x.targetLength=t===e?t.scrollWidth:t.clientWidth,o.y.targetLength=t===e?t.scrollHeight:t.clientHeight,o.x.containerLength=e.clientWidth,o.y.containerLength=e.clientHeight}function Pe(e,t,o,n={}){return{measure:()=>Te(e,n.target,o),update:s=>{He(e,o,s),(n.offset||n.target)&&Ne(e,o,n)},notify:()=>t(o)}}const x=new WeakMap,N=new WeakMap,B=new WeakMap,T=e=>e===document.documentElement?window:e;function _e(e,{container:t=document.documentElement,...o}={}){let n=B.get(t);n||(n=new Set,B.set(t,n));const s=ze(),i=Pe(t,e,s,o);if(n.add(i),!x.has(t)){const a=()=>{for(const c of n)c.measure()},u=()=>{for(const c of n)c.update(A.timestamp)},f=()=>{for(const c of n)c.notify()},g=()=>{w.read(a,!1,!0),w.update(u,!1,!0),w.update(f,!1,!0)};x.set(t,g);const v=T(t);window.addEventListener("resize",g,{passive:!0}),t!==document.documentElement&&N.set(t,ke(t,g)),v.addEventListener("scroll",g,{passive:!0})}const l=x.get(t);return w.read(l,!1,!0),()=>{var a;Z(l);const u=B.get(t);if(!u||(u.delete(i),u.size))return;const f=x.get(t);x.delete(t),f&&(T(t).removeEventListener("scroll",f),(a=N.get(t))===null||a===void 0||a(),window.removeEventListener("resize",f))}}function P(e,t){ee(!!(!t||t.current))}const De=()=>({scrollX:y(0),scrollY:y(0),scrollXProgress:y(0),scrollYProgress:y(0)});function Fe({container:e,target:t,layoutEffect:o=!0,...n}={}){const s=D(De);return(o?V:d.useEffect)(()=>(P("target",t),P("container",e),_e(({x:l,y:a})=>{s.scrollX.set(l.current),s.scrollXProgress.set(l.progress),s.scrollY.set(a.current),s.scrollYProgress.set(a.progress)},{...n,container:(e==null?void 0:e.current)||void 0,target:(t==null?void 0:t.current)||void 0})),[e,t,JSON.stringify(n.offset)]),s}var Ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 732h-70.3c-4.8 0-9.3 2.1-12.3 5.8-7 8.5-14.5 16.7-22.4 24.5a353.84 353.84 0 01-112.7 75.9A352.8 352.8 0 01512.4 866c-47.9 0-94.3-9.4-137.9-27.8a353.84 353.84 0 01-112.7-75.9 353.28 353.28 0 01-76-112.5C167.3 606.2 158 559.9 158 512s9.4-94.2 27.8-137.8c17.8-42.1 43.4-80 76-112.5s70.5-58.1 112.7-75.9c43.6-18.4 90-27.8 137.9-27.8 47.9 0 94.3 9.3 137.9 27.8 42.2 17.8 80.1 43.4 112.7 75.9 7.9 7.9 15.3 16.1 22.4 24.5 3 3.7 7.6 5.8 12.3 5.8H868c6.3 0 10.2-7 6.7-12.3C798 160.5 663.8 81.6 511.3 82 271.7 82.6 79.6 277.1 82 516.4 84.4 751.9 276.2 942 512.4 942c152.1 0 285.7-78.8 362.3-197.7 3.4-5.3-.4-12.3-6.7-12.3zm88.9-226.3L815 393.7c-5.3-4.2-13-.4-13 6.3v76H488c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h314v76c0 6.7 7.8 10.5 13 6.3l141.9-112a8 8 0 000-12.6z"}}]},name:"logout",theme:"outlined"};const Ue=Ve;var Xe=function(t,o){return d.createElement(te,ne({},t,{ref:o,icon:Ue}))};const Ye=d.forwardRef(Xe);function $e(){const{scrollYProgress:e}=Fe(0),t=ve(e,{stiffness:100,damping:30,restDelta:.001});return r.jsx(b.div,{className:"progress-bar",style:{scaleX:t}})}function Ge(){const e=E(n=>n.loginState.loginState),t=se(),o=[{key:"1",label:r.jsx(qe,{}),icon:r.jsx(I,{})},{type:"divider"},e?{key:"2",label:r.jsx(Je,{}),icon:r.jsx(Ye,{})}:null];return r.jsx("div",{id:"area",children:r.jsx(ge,{menu:{items:o,forceSubMenuRender:!0},arrow:{pointAtCenter:!0},placement:"bottomRight",forceRender:!0,children:r.jsx(me,{className:"",size:25,icon:r.jsx(I,{}),shape:"square",onClick:U("account_name")?()=>t("/userinfo"):()=>t("/login")})})})}function qe(){return E(t=>t.loginState.loginState)?r.jsx(m,{to:"/userinfo",children:U("account_name")}):r.jsx(m,{to:"/login",children:"登录|注册"})}function Je(){const e=E(n=>n.loginState.loginState),t=X();function o(){localStorage.removeItem("account_name"),localStorage.removeItem("refresh_token"),localStorage.removeItem("access_token"),localStorage.setItem("account_LoginTime",0*1),t(oe()),t(re(0))}return e?r.jsx(r.Fragment,{children:e&&r.jsx(m,{to:"/login",replace:!0,onClick:o,children:"注销"})}):!1}const _={color:"black"},Ke={color:"white"};function z(e){const{isScrolled:t}=e;return r.jsx(b.div,{initial:_,animate:t?Ke:_,children:e.children})}const Qe=()=>{const e=E(c=>c.loginState.loginState),[t,o]=d.useState(!1),n=[{label:r.jsx(p,{children:r.jsx(m,{to:"/",children:r.jsx(ae,{})})}),key:"home"},e?{label:r.jsx("div",{children:r.jsx(p,{children:r.jsx(Ge,{})})}),key:"avatar",popupClassName:"useravatar"}:null,{label:r.jsx(z,{isScrolled:t,children:r.jsx(p,{children:r.jsxs(m,{to:"/article",children:[r.jsx(C,{}),"Article"]})})}),key:"article"},{label:r.jsx(z,{isScrolled:t,children:r.jsx(p,{children:r.jsxs(m,{to:"/ipfs",children:[r.jsx(C,{}),"IPFS"]})})}),key:"ipfs"},e?{label:r.jsx(z,{isScrolled:t,children:r.jsx(p,{children:r.jsxs(m,{to:"/music",children:[r.jsx(ce,{}),"Music"]})})}),key:"music"}:null,{label:r.jsx(p,{children:r.jsx(ue,{})}),key:"SubMenu",children:[e?NaN:{label:r.jsxs(m,{to:"/login",children:[r.jsx(de,{})," Login"]}),key:"login"},{label:"undetermined",key:"un"}]}],s=X(),i=d.useRef(null);d.useEffect(()=>{if(i.current&&i.current.offsetHeight){const c=i.current.offsetHeight;s(ie(c))}},[i,s]);const[l,a]=d.useState("mail"),u=c=>{a(c.key)},f={backgroundColor:"rgba(0,0,0,0)"},g={backgroundColor:"#00000050",backdropFilter:"blur(10px)"};d.useEffect(()=>{const c=()=>{(document.documentElement.scrollTop||document.body.scrollTop)>0?o(!0):o(!1)};return window.addEventListener("scroll",c),()=>{window.removeEventListener("scroll",c)}},[t]);const v={components:{Menu:{itemBg:"rgba(0, 0, 0, 0)",itemBorderRadius:8,itemHoverBg:"rgba(0, 0, 0, 0.06)",subMenuItemBorderRadius:8},Dropdown:{borderRadiusOuter:4,controlItemBgActive:"rgba(0, 0, 0, 0)",controlItemBgHover:"rgba(0, 0, 0, 0)"}}};return r.jsx(le,{theme:v,children:r.jsx(b.div,{ref:i,className:"sticky-top",initial:f,animate:t?g:f,transition:{duration:.8},children:r.jsxs(b.div,{initial:{opacity:0,scale:.99},animate:{opacity:1,scale:1},transition:{delay:0,duration:.4},children:[r.jsx(fe,{children:r.jsx(he,{onClick:u,selectedKeys:[l],mode:"horizontal",items:n,style:{borderBottom:"none"}})}),r.jsx($e,{})]})})})},rt=Qe;export{rt as N};
